======================================================================
  WhisperSign - Deep Technical Verification Suite
======================================================================

--- SECTION 1: Tensor Shape Propagation ---
  [OK] PatchEmbed exact div (120/4=30)............................. PASS (torch.Size([2, 30, 256]))
  [OK] PatchEmbed non-div pad (123->124/4=31)...................... PASS (torch.Size([2, 31, 256]))
  [OK] ConvSPE shape preservation.................................. PASS
  [OK] ConvSPE residual connection................................. PASS
  [OK] Frontend output shape....................................... PASS (torch.Size([2, 30, 256]))
  [OK] Frontend output lengths..................................... PASS ([30, 20])
  [OK] SpatialAttention shape...................................... PASS
  [OK] TemporalAttention shape..................................... PASS
  [OK] SpatioTemporalBlock shape................................... PASS
  [OK] Encoder shape............................................... PASS
  [OK] CTCDecoder shape............................................ PASS
  [OK] AttentionDecoder shape...................................... PASS
  [OK] Full model CTC shape........................................ PASS
  [OK] Full model encoder shape.................................... PASS

--- SECTION 2: Gradient Flow & Backward Pass ---
  [OK] Gradients reach Frontend.................................... PASS (9 params with grad)
  [OK] Gradients reach Encoder..................................... PASS (42 params with grad)
  [OK] Gradients reach CTC Decoder................................. PASS (2 params with grad)
  [OK] Input tensor has gradient................................... PASS
  [OK] All gradients are finite (no NaN/Inf)....................... PASS
  [OK] Frozen encoder: no gradients................................ PASS
  [OK] Frozen encoder: frontend still has grads.................... PASS

--- SECTION 3: Loss Computation ---
  [OK] CTC loss is positive........................................ PASS
  [OK] CTC loss is finite.......................................... PASS
  [OK] Total = CTC when alpha=1.0.................................. PASS
  [OK] Hybrid loss has all components.............................. PASS
  [OK] Hybrid loss formula L=0.3*CTC+0.7*ATT....................... PASS
  [OK] CTC loss backward succeeds.................................. PASS

--- SECTION 4: Checkpoint Round-Trip ---
  [OK] Checkpoint epoch preserved.................................. PASS
  [OK] Checkpoint loss preserved................................... PASS
  [OK] All weights identical after load............................ PASS
  [OK] Same output after checkpoint load........................... PASS

--- SECTION 5: Simulated Training Step ---
  [OK] 5 training steps completed.................................. PASS
  [OK] All training losses finite.................................. PASS
  [OK] Loss decreased over 5 steps................................. PASS (30.8096 -> 0.5409)

--- SECTION 6: Edge Cases ---
  [OK] Batch size 1................................................ PASS
  [OK] Minimum seq len (4 frames = 1 patch)........................ PASS
  [OK] All-zero input doesn't crash................................ PASS
  [OK] All-zero output is finite................................... PASS
  [OK] Long sequence (600 frames).................................. PASS
  [OK] Decoded tokens in valid range............................... PASS

--- SECTION 7: Normalization & Preprocessing ---
  [OK] Spatial norm palm is zero................................... PASS
  [OK] Spatial norm right palm zero................................ PASS
  [OK] Scale norm no NaN........................................... PASS
  [OK] Scale norm no Inf........................................... PASS
  [OK] FeatureScaler mean ~0....................................... PASS
  [OK] FeatureScaler std ~1........................................ PASS
  [OK] Sliding windows created..................................... PASS (10 windows)
  [OK] Window shape correct........................................ PASS
  [OK] Resample preserves start time............................... PASS
  [OK] Resample preserves end time................................. PASS
  [OK] Mask sum equals seq_len..................................... PASS
  [OK] Mask valid region is True................................... PASS

--- SECTION 8: Augmentation ---
  [OK] GestureMasking masks joints................................. PASS
  [OK] TemporalJitter preserves shape.............................. PASS
  [OK] NoiseInjection adds noise................................... PASS
  [OK] NoiseInjection magnitude reasonable......................... PASS
  [OK] ComposeAugmentations runs................................... PASS

--- SECTION 9: Numerical Stability ---
  [OK] Large input (x100) no NaN................................... PASS
  [OK] Small input (x0.001) no NaN................................. PASS
  [OK] CTC outputs are valid log-probs............................. PASS

--- SECTION 10: Learning Rate Scheduler ---
  [OK] LR starts near 0............................................ PASS
  [OK] LR peaks around warmup end.................................. PASS
  [OK] LR decays after warmup...................................... PASS
  [OK] LR above min_lr............................................. PASS

--- SECTION 11: Parameter Counts ---
  [OK] All params trainable initially.............................. PASS
  [OK] Freeze reduces trainable count.............................. PASS
  [OK] Double freeze further reduces............................... PASS
  [OK] Unfreeze restores all params................................ PASS

  Total params: 4,245,704
  After freeze encoder: 2,151,624 (frontend+decoder)
  After freeze both: 467,044 (frontend only)

======================================================================
  RESULTS: 68 passed, 0 failed, 68 total
======================================================================
  >>> ALL TESTS PASSED <<<
